<?xml version="1.0" encoding="UTF-8"?>

<messages>
	<message id="GET_IMPACTED_PRODUCTS">
		SELECT
		DISTINCT
		PCDV.PRODUCT_LINE_CODE,CP.CODE,CP.FG,
		CPMS.ID,PCDV.ORGXPG_ORGANIZATION_CODE ,PCDV.PNL_FAMILY_CODE,
		PCDV.PRODUCT_GROUP_CODE, PCDV.PRODUCT_DIVISION_CODE,1
		,NVL(RNP.PUBLICATION_TARGET,'C'),PID.INDUSTRY_DOMAIN__CODE,
		PM_CP.PRODUCT_MATURITY__CODE , CP.INPUT ,
		ID.descr ind_descr,pid.industry_dom_compliancy__code,grp.descr grp_descr,PM_FG.PRODUCT_MATURITY__CODE fg_mat,pl.descr pl_descr,PCDV.PNL_FAMILY_DESCR
		FROM
		(
		SELECT
		DISTINCT
		PLM_BOM_HEADER__CODE CODE, PLM_MATERIAL__CODE FG , connect_by_root PLM_MATERIAL__CODE
		INPUT
		FROM PLM_BOM_ITEM
		WHERE ACTIVITY_STATUS__CODE='30' AND
		PLM_BOM_HEADER_TYPE__CODE = 'CP'
		START WITH PLM_MATERIAL_TYPE__CODE =
		'WAF'
		AND PLM_MATERIAL__CODE IN
		(SELECT DISTINCT PM.CODE FROM
		PLM_MATERIAL PM WHERE PM.PRODUCT_MATURITY__CODE
		&lt; '90' AND PM.MTART
		!= 'PSDO'
		
	</message>

	<message id="GET_IMPACTED_PRODUCTS_CONDITION">
		CONNECT BY PRIOR PLM_BOM_HEADER__CODE = PLM_MATERIAL__CODE AND PRIOR
		PLM_BOM_HEADER_TYPE__CODE = PLM_MATERIAL_TYPE__CODE
		AND PRIOR
		ACTIVITY_STATUS__CODE='30') CP,RN_PRODUCT_VW RNP,
		PCN_CP_DATA_VIEW
		PCDV, COMM_PRODT_MULTPL_SOURCE CPMS, PLM_MATERIAL
		PM_CP, PLM_MATERIAL
		PM_FG ,PRODUCT_X_INDUSTRY_DOM PID,
		INDUSTRY_DOMAIN ID, product_group grp,product_line pl
		WHERE
		CP.CODE =
		PM_CP.CODE AND PM_CP.TYPE='CP' AND PM_CP.MTART != 'PSDO' AND
		PM_CP.PRODUCT_LINE__CODE=PCDV.PRODUCT_LINE_CODE
		AND
		PM_CP.PRODUCT_MATURITY__CODE >= '10' AND PM_CP.CODE = RNP.COMMERCIAL_PRODUCT__CODE(+) AND
		CPMS.COMMERCIAL_PRODUCT__CODE=CP.CODE AND
		CPMS.FINISHED_GOOD__CODE=CP.FG AND CPMS.ACTIVITY_STATUS__CODE='30' AND
		PM_FG.CODE=CP.FG AND PM_FG.TYPE='FG'
		AND PM_FG.MTART != 'PSDO' AND
		PM_FG.PRODUCT_MATURITY__CODE >= '10' and
		PM_FG.PRODUCT_MATURITY__CODE  <![CDATA[<= ]]>
		'90' AND CP.FG = RPAD(PID.PRODUCT__CODE(+),16,' ')
		AND
		PID.PRODUCT_TYPE__CODE(+) = 2 AND PID.INDUSTRY_DOMAIN__CODE(+) = '10'
		AND PID.INDUSTRY_DOMAIN__CODE = ID.CODE(+) AND
		PID.ACTIVITY_STATUS__CODE(+) != '90'
		AND PCDV.PRODUCT_GROUP_CODE !=
		'11'         and grp.code = PCDV.PRODUCT_GROUP_CODE
		and pl.code = PCDV.PRODUCT_LINE_CODE

	</message>

	<message id="GET_IMPACTED_CUSTOMERS">
		SELECT
		DISTINCT VW.CODE VW_CODE, VW.SHORT_NAME
		VW_SHORT_NAME,VW.FIELD_SALES_ENGR__CODE VW_FIELD_SALES_ENGR__CODE,
		VW.DESCR VW_DESCR ,
		VW.CUSTOMER_TYPE__CODE
		VW_CUSTOMER_TYPE__CODE,'Y',MIN(MS.MACRO_SEGMENT__CODE) MS_CODE ,mac.descr aa,cst.customer_group__code , cg.descr, vw.customer_ship_to__code,
		TPXCP.cp,TPXCP.fg
		FROM
		MV_CPCN_CUSTOMER_LIST VW,NOTICE_IMPACTED_PRODUCTS TPXCP
		,CUSTOMER_SHIP_TO CST,
		MARKET_SEGMENT MS, macro_segment mac,customer_group cg
		WHERE TPXCP.CP =
		trim(VW.COMMERCIAL_PRODUCT__CODE) AND TPXCP.FG =
		trim(VW.FINISHED_GOOD__CODE)
		AND VW.PARENT_COMPANY_ORG__CODE= 'STM' AND
		VW.CUSTOMER_SHIP_TO__CODE=CST.ID AND
		CST.MARKET_SEGMENT__CODE=MS.CODE
		 and ms.MACRO_SEGMENT__CODE = mac.code
   		 and cg.code = cst.customer_group__code 
		AND NOT EXISTS ( SELECT 1 FROM COMM_PRODT_MULTPL_SOURCE CPMS ,
		CP_MULTPL_SOURCE_X_CUST CPMSXC WHERE CPMS.ID =
		CPMSXC.CPRODT_MULTPL_SOURCE__ID AND
		SUBSTR(VW.CUSTOMER_SHIP_TO__CODE,1,8) = CPMSXC.CUSTOMER__CODE
		AND
		TPXCP.CP = CPMS.COMMERCIAL_PRODUCT__CODE AND
		CPMS.ACTIVITY_STATUS__CODE = '30' AND CPMSXC.ACTIVITY_STATUS__CODE
		='30')
		AND NOT EXISTS



		( SELECT 1 FROM CP_MULTPL_SOURCE_X_CUST CPMSXC2,
		COMM_PRODT_MULTPL_SOURCE CPMS1 WHERE TPXCP.CPMS_ID =
		CPMSXC2.CPRODT_MULTPL_SOURCE__ID AND
		CPMS1.ID=CPMSXC2.CPRODT_MULTPL_SOURCE__ID
		AND CPMSXC2.CUSTOMER__CODE !=
		VW.CODE AND CPMS1.ACTIVITY_STATUS__CODE =
		'30' AND
		CPMSXC2.ACTIVITY_STATUS__CODE = '30' AND
		CPMS1.RESERVED_FLAG='YS'
		AND
		TPXCP.FG != CPMS1.FINISHED_GOOD__CODE)

		GROUP BY
		VW.CODE,VW.SHORT_NAME,VW.FIELD_SALES_ENGR__CODE,VW.DESCR,VW.CUSTOMER_TYPE__CODE,mac.descr ,cst.customer_group__code, cg.descr, vw.customer_ship_to__code
		,TPXCP.cp,TPXCP.fg

		UNION
		SELECT DISTINCT VW.CODE VW_CODE, VW.SHORT_NAME
		VW_SHORT_NAME,VW.FIELD_SALES_ENGR__CODE
		VW_FIELD_SALES_ENGR__CODE,
		VW.DESCR VW_DESCR,VW.CUSTOMER_TYPE__CODE
		VW_CUSTOMER_TYPE__CODE,'Y',MIN(MS.MACRO_SEGMENT__CODE) MS_CODE,mac.descr  aa,cst.customer_group__code, cg.descr, vw.customer_ship_to__code
		,TPXCP.cp,TPXCP.fg
		FROM
		MV_CPCN_CUSTOMER_LIST VW,NOTICE_IMPACTED_PRODUCTS TPXCP,
		CP_MULTPL_SOURCE_X_CUST CPMSXC
		,CUSTOMER_SHIP_TO CST, MARKET_SEGMENT MS, macro_segment mac,customer_group cg

		WHERE
		TPXCP.CPMS_ID = CPMSXC.CPRODT_MULTPL_SOURCE__ID AND TPXCP.CP =
		trim(VW.COMMERCIAL_PRODUCT__CODE)
		AND TPXCP.FG =
		trim(VW.FINISHED_GOOD__CODE) AND
		CPMSXC.ACTIVITY_STATUS__CODE = '30'
		AND CPMSXC.CUSTOMER__CODE = VW.CODE AND VW.PARENT_COMPANY_ORG__CODE=
		'STM' AND VW.CUSTOMER_SHIP_TO__CODE=CST.ID
		AND
		CST.MARKET_SEGMENT__CODE=MS.CODE 
		 and cg.code = cst.customer_group__code 
		 GROUP BY
		VW.CODE,VW.SHORT_NAME,VW.FIELD_SALES_ENGR__CODE,VW.DESCR,VW.CUSTOMER_TYPE__CODE, mac.descr,cst.customer_group__code, cg.descr, vw.customer_ship_to__code
		,TPXCP.cp,TPXCP.fg
	</message>

	<message id="INSERT_TMP_IMPACTED_PRODUCTS">
		INSERT INTO NOTICE_IMPACTED_PRODUCTS VALUES (?,?,?)

	</message>

	<message id="SELECT_ALL_PRODUCT_GROUP">
		select CODE From PRODUCT_GROUP
	</message>

	<message id="SELECT_PRODUCT_DIV_BY_GRP">
		select CODE from PRODUCT_DIVISION where
		PRODUCT_GROUP__CODE = ?
	</message>

	<message id="SELECT_ALL_COMM_PRODUCT">
		select CODE from PLM_MATERIAL where TYPE= 'CP'
	</message>

	<message id="SELECT_FG_BY_CP">
		select PlM_MATERIAL__CODE from PLM_BOM_ITEM where
		PLM_BOM_HEADER__CODE = ?
	</message>



	<message id="GET_PROD_GRP_CONTACT">
		from ProductGroup
	</message>
	<message id="GET_QUAlIOWNER_CONTACT">
		from QualifOwner
	</message>

	<message id="GET_NOTIFICATION_LIST_FOR_NOTICE">
		FROM Notification as notification WHERE notification.status =
		'GENERATED' and notification.autoEmail = 'Y'
		<!-- SELECT cntct.customer_name, cntct.customer_email FROM noticedb.t_notification 
			n JOIN noticedb.tm_address addrs ON n.address= addrs.address JOIN noticedb.tm_contact 
			cntct message ON addrs.address_id = cntct.address__id WHERE n.status='GENERATED' 
			AND N.auto_email='Y' -->
	</message>

	<message id="GET_CUSTOMER_LIST_FOR_NOTICE">
		SELECT cntct.customer_name, cntct.customer_email,
		cntct.to_or_cc
		FROM noticedb.tm_address ad
		JOIN noticedb.tm_contact
		cntct
		ON ad.address_id = cntct.address__id
		WHERE ad.customer_code = ?
	
	</message>
	
	<message id="S_ALL_CUSTOMER_GRP">
		from CustomerGroup
	</message>
	<message id="S_ALL_CUSTOMER_ADDRESS">
		from CustomerAddressEntity
	</message>

	<message id="S_ALL_CUSTOMER_NOTIFICATION">
		from Notification where notice.internalId=?
	</message>
	<message id="S_NOTICE_REVIEWER">
		from NoticeReviewer R WHERE R.notice.internalId=? AND R.type=? 
	</message>

	<message id="S_ALL_NOTICE_REVIEWER">
		from NoticeReviewer R WHERE R.notice.internalId=?  
	</message>

	<message id="S_CUSTOMER_FEEDBACK">
		from Feedback
	</message>

	<message id="GET_FEEDBACK_ACTION">
		from FeedbackAction WHERE actionId=?
	</message>

	<message id="GET_ALL_NOTIFICATION">
		from Notification N WHERE N.notice.internalId=?
	</message>
<message id="GET_ALL_NOTIFICATIONDETAIL_BY_NOTIFICATIONID">
		from NotificationDetail WHERE notification__id=?
	</message>
	<message id="GET_USER_PREFERENCE">
               
 Select new UserPreferences (pref.internalId,pref.propertyName,pref.propertyValue,pref.eduid)
        from UserPreferences as pref
        WHERE pref.eduid = ?
    </message>	
 
	<message id="SEARCH_NOTICE">
	 


 SELECT DISTINCT notice.pcp_id, notice.notice_id ,notice.title,
	     notice.status, notice.creation_date, 
	     
	      (SELECT  details.name
                FROM t_user_details details,t_user_role role WHERE 
                 role.role='PCN Coordinator' AND details.st_eduid = role.user_detail__st_eduid
                AND role.notice__id = notice.notice_id LIMIT 1) PCN_COORDINATOR,
                
	     notice.domain, notice.change_type
	     
	     FROM t_notice notice
	    
	         JOIN t_user_role u ON notice.notice_ID = u.NOTICE__ID
	
	
	
	    
    </message>
 <message id="SEARCH_PCN_COUNT">
    SELECT count(*)
		from(
		  SELECT DISTINCT notice.pcp_id, notice.notice_id ,notice.title,
	     notice.status, notice.creation_date, notice.domain, notice.change_type
	    
	     FROM t_notice notice
	    
	         JOIN t_user_role u ON notice.notice_ID = u.NOTICE__ID
	    
    </message>

<message id="GET_ALL_NOTICE_REVIEWER">
		from NoticeReviewer r where r.notice.internalId = ?
	</message>
	
	
	<message id="GET_FEEDBACK_ACTION">
	 from FeedbackAction a where a.actionId = ?
	</message>
	
	<message id="SELECT_CRB_REVIEWERS_TEAM_REVIEWERS">
	from NoticeReviewer r where r.notice.internalId = ? and r.type = ?
	</message>
	<message id="SELECT_TEAM_APPROVERS">
	from UserRole u where u.notice.internalId = ? and u.role in ( 'PRODUCT MANAGER','MARKETING MANAGER','QUALITY MANAGER','PROCESS OWNER','CORPORATE QUALITY MANAGER')
	</message>

	<message id ="GET_PCN_COORDINATOR">
	from UserRole u where u.notice.internalId = ? and u.role = ?
	</message>

<message id ="GET_SAMPLE_OWNER_BY_GROUP_ID">
from SampleOwner so where so.group = ?
</message>

	<message id="GET_NOTIFICATION_DETAILS">
		from Notification notification WHERE notification.internalId in
	</message>
	<message id="GET_NOTIFICATIONDETAIL_BY_NOTIFICATIONID">
		from NotificationDetail ND where
		ND.notification.internalId in 
	</message>
	<message id="GET_NOTIFICATIONDETAIL_BY_NOTICEID">
		from NotificationDetail ND where
		ND.notification.notice.internalId=?
	</message>
	<message id="GET_ONGOING_PCPN_BY_CUSTOMERCODE">
		select distinct notice from Notice notice inner join
		notice.notificationList
		notification
		where
		notification.customerName in
	</message>

	<message id="GET_NOTIFICATIONDETAIL_FOR_NOTIFICATIONID">
		from Notification notification WHERE notification.internalId in
	</message>

	<message id="S_ALL_NOTIFICATION_SENDING">
		from Notification notification where 
		notification.notice.internalId = ? 
		and	notification.status !='' 
		
	</message>
	<message id="GET_NOTIFICATIOND_BY_NOTICEID">
		from Notification notification where 
		notification.notice.internalId = ? 
		and notification.fseEduid = ? 
		and	notification.status !='' 
		
	</message>
	<!-- <message id="GET_NOTIFICATIOND_BY_NOTICEID">
		from Notification notification where 
		notification.type in ('GENERATED') 
		and	notice.internalId =? 		
	</message> -->
	<message id="GET_IMPACTED_PRODUCTS_BY_NOTICEID">
		from ImpactedProduct where notice.internalId = ?
	</message>
	<message id="GET_IMPACTED_PRODUCTS_WHERE_ID_IS">
		from ImpactedProduct where impacted_product_id in
	</message>
	<message id="GET_INPUT_PRODUCTS_BY_NOTICEID">
		from InputProduct where notice.internalId = ?
	</message>
	<message id="GET_ONGOING_PCN">
		select distinct notice from Notice notice inner join
		notice.impactedProductList
		impactedProduct where notice.status in (
		'DRAFT','OPEN') and
		impactedProduct.finishGood in
	</message>

	<message id="SELECT_CUSTOMER_DESC">
		select CODE,DESCR from customer_group
	</message>
	<message id="SELECT_CUSTOMER_NAME">
		select CODE,short_name from customer 

	</message>
	<message id="SELECT_CUSTOMER_SHIP_TO">
		select ID,ID id1 from customer_ship_to
	</message>

	<message id="SELECT_CUSTOMER_DESC_RELEASE">
		select CODE,DESCR from customer_group
	</message>

	<message id="SELECT_CUSTOMER_GROUPING_ENTITY">
		from CustomerGroup
	</message>
<message id="SELECT_CUSTOMER_RELEASE_ENTITY">
		from ReleaseEntity
	</message>
	
    <message id="S_MY_PCN">
		SELECT distinct
			n.notice_id,n.status,n.title,n.type_of_change,n.change_type
			FROM t_notice n, t_user_role r
			WHERE n.notice_id = r.notice__id
			AND r.USER_DETAIL__ST_EDUID =
	</message>
	<message id="GET_NOTIFICATION_DOCUMENT_BY_NOTIFICATIONID">
		from NotificationDocument where
		notification.internalId in
	</message>
	
		<message id="SELECT_CUSTOEMR_ADDRESS_BY_RELEASE_ENTITY">
		 from CustomerAddressEntity where custReleaseEntity = ?
	</message>
	
	<message id="SELECT_CUSTOEMR_ADDRESS_BY_CUST_GROUP">
		 from CustomerAddressEntity where custGroupingEntity = ?
	</message>
	<message id="S_ALL_CUSTOMER_CONTACT_BY_ADDRESSID">
		 from NotificationContacts n where n.customerAddressEntity.internalId = ?
	</message>
	<message id="S_ALL_CUSTOMER_ADDRESS_BYADDRESSID">
		 from CustomerAddressEntity customerAddressEntity where customerAddressEntity.internalId = ?
	</message>
	
			<message id="GET_DATA_FOR_ARROVAL_BY_NOTICEID">
		 from Approval where notice.internalId = ?
		</message>
		
	<message id="GET_ALL_NOTIFICATION_FOR_BATCH">
		 from Notification notification where 
		 notification.autoEmail = 'Y'		
		and	notification.status in ('GENERATED')
	</message>
	<message id="GET_NOTICE_FOR_DMS">
     from Notice notice where
     notice.dmsReference IS NOT NULL 
     and notice.dmsStatus != ('REJECTED')
     and notice.dmsStatus NOT IN ('Not Required','Rejected','Approved')  
    </message>
    
    <message id="GET_USER_ROLES_BY_NOTICE_ID">
     from UserRole where notice.internalId = ?
    </message>
	<message id="GET_SAMPLES_WHERE_IMPACTED_PRODUCT_ID_IS">
		from Sample where impactedProduct.internalId = ?
	</message>
	
	
	<message id="GET_PCN_COORDINATOR_BY_NOTICEID">
		from UserRole where notice.internalId = ?
	</message>
